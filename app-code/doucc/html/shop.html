<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>shop</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link rel="stylesheet" href="../css/mui.min.css">
		<link rel="stylesheet" href="../css/main.css">
		<style>
			html,body {
				background-color: #efeff4;
			}
			
			
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" style="padding-right: 15px;">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">商城</h1>
		</header>
		<div class="mui-content">
			
			<ul id="product-list" class="mui-table-view mui-table-view-striped mui-table-view-condensed">
				<li class="mui-table-view-cell">
					<div class="mui-slider-cell">
						<div class="mui-table">
							<div class="mui-table-cell shop-img">
								<img src="../images/60x60.gif" />
							</div>
							<div class="mui-table-cell shop-text">
								<div class="mui-clearfix">
									<h4 id="ddddd" class="">抖音云端机器人</h4>
									<span class="mui-h5">1800元</span>
								</div>
								
							</div>
							<div class="mui-table-cell shop-action">
								<button data-id="1" type="button" class="mui-btn mui-btn-primary btn-buy">购买</button>
							</div>
							
						</div>
					</div>
				</li>
			
			</ul>
		</div>
	</body>
	<script src="../js/mui.min.js"></script>
	<script src="../js/main.js"></script>
	<script>
		mui.init({
			swipeBack:true //启用右滑关闭功能
		});
		mui.plusReady(function() {
			mui.ajax(config.host + 'index.php?s=product/get_product', {
				data:{
					username:'username',
					password:'password'
				},
				dataType:'json',//服务器返回json格式数据
				type:'post',//HTTP请求类型
				timeout:10000,//超时时间设置为10秒；
				headers:{'Content-Type':'application/json'},
				success:function(data){
					console.log(data)
					alert(JSON.stringify(data));
					//服务器返回响应，根据响应结果，分析是否登录成功；
					if(data.code == 0){
						mui.alert(data.msg);
					}else{
						var html = "";
						for(var i in data.data){
							html += '<li class="mui-table-view-cell">';
						}
						var plist = document.getElementById("product-list");
						plist.innerHTML = html;
					}
					
				},
				error:function(xhr,type,errorThrown){
					//异常处理；
					// mui.alert("商城");
					// document.getElementById("ddddd").innerHTML = "抖音云端机器人88";
					console.log(type);
				}
			});
			
			
			mui("#product-list").on('tap', '.btn-buy', function(){
				var productid = this.getAttribute("data-id");
				mui.ajax(config.host + 'index.php?s=order/createOrder', {
					data:{
						productid: 888,
					},
					dataType:'json',//服务器返回json格式数据
					type:'post',//HTTP请求类型
					timeout:10000,//超时时间设置为10秒；
					headers:{'Content-Type':'application/json'},
					success:function(data){
						console.log(data)
						alert(JSON.stringify(data));
						//服务器返回响应，根据响应结果，分析是否登录成功；
						if(data.code == 0){
							mui.alert(data.msg);
						}else{
							// http://doucc.com/index.php?s=cash/unionpay
							var url = "https://baidu.com";
							plus.webview.loadURL(url);
						   
						 //  plus.webview.create('http://www.baidu.com', 'baidu', {popGesture:'hide',navigationbar:{backgroundColor:'#FFFFFF',titleColor:'#000000',backButton:{color:'#007AFF',colorPressed:'#0000FF'}}}).show('pop-in');
						   
						}
						
					},
					error:function(xhr,type,errorThrown){
						//异常处理；
						// mui.alert("商城");
						console.log(type);
					}
				});
			});
			
		   
			// 访问外部网址返回处理
			/*
			plus.webview.create('http://www.baidu.com', 'baidu', {popGesture:'hide',navigationbar:{backgroundColor:'#FFFFFF',titleColor:'#000000',backButton:{color:'#007AFF',colorPressed:'#0000FF'}}}).show('pop-in'); // debug
			mui.oldBack = mui.back;  
			mui.back = function(event) {  
			    var baidu = plus.webview.getWebviewById('baidu');  
			    if(baidu){  
			        return baidu.canBack( function(e){  
			                if(e.canBack){  
			                        baidu.back();  
			                }else{  
			                        baidu.close();  
			                }  
			        });  
			    }  
			    mui.oldBack();  
			    return false;  
			};
			*/
			
		});
		
	</script>
</html>